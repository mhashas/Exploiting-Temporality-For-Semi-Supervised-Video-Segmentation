from trainer import Trainer
from parser_options import ParserOptions
from util.general_functions import print_training_info

def main():
    args = ParserOptions().parse()  # get training options
    trainer = Trainer(args)

    print_training_info(args)

    for epoch in range(trainer.args.start_epoch, trainer.args.epochs):
        trainer.training(epoch)

        if epoch % args.eval_interval == (args.eval_interval - 1):
            trainer.validation(epoch)

    if args.segmentation:
        trainer.visualization(args.vis_split)
        trainer.save_network()

    trainer.summary.writer.add_scalar('val/bestmIoU', trainer.best_mIoU, args.epochs)
    trainer.summary.writer.close()

if __name__ == "__main__":
   main()
